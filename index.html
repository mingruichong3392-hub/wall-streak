<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wall Streak ‚Äî Keep your streak, beat the Street</title>
  <meta name="description" content="Wall Streak ‚Äî your daily market puzzle. Keep your streak, beat the Street." />
  <meta property="og:title" content="Wall Streak ‚Äî Keep your streak, beat the Street" />
  <meta property="og:description" content="Your daily market puzzle. Monday‚ÄìSaturday." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="og-image.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üî•</text></svg>">
  <style>
    .card { @apply rounded-2xl border border-slate-200 bg-white/80 backdrop-blur p-5 shadow; }
    .btn  { @apply px-5 py-3 rounded-xl font-semibold shadow active:translate-y-px transition; }
    .btn-primary { @apply bg-emerald-600 text-white hover:bg-emerald-700; }
    .btn-secondary { @apply bg-slate-100 hover:bg-slate-200; }
    .tag { @apply inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-700; }

    /* Colored MCQ pills */
    .mcq { @apply w-full rounded-xl px-4 py-3 text-center font-semibold border transition; }
    .mcq-a { @apply bg-indigo-100  border-indigo-300  hover:bg-indigo-200; }
    .mcq-b { @apply bg-sky-100     border-sky-300     hover:bg-sky-200; }
    .mcq-c { @apply bg-emerald-100 border-emerald-300 hover:bg-emerald-200; }
    .mcq-d { @apply bg-amber-100   border-amber-300   hover:bg-amber-200; }
    .mcq.correct { @apply border-emerald-500 bg-emerald-50; }
    .mcq.wrong   { @apply border-rose-400    bg-rose-50; }

    /* Highlight Give up */
    .btn-reveal { @apply bg-rose-100 text-rose-700 border border-rose-300 hover:bg-rose-200; }

    /* Result boxes (replace card) */
    .resultBox { @apply rounded-2xl p-5 border-2; }
    .result-success { @apply bg-emerald-50 border-emerald-400; }
    .result-fail    { @apply bg-rose-50    border-rose-400; }
    .result-title   { @apply text-xl font-extrabold flex items-center gap-2 mb-1; }
    .result-sub     { @apply text-sm text-slate-700 mb-3; }
  </style>
</head>
<body class="min-h-screen bg-slate-50 text-slate-900">
  <div class="mx-auto max-w-xl px-4 py-8">
    <!-- Header -->
    <header class="mb-6 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="text-2xl">üî•</div>
        <div>
          <h1 class="text-2xl font-extrabold tracking-tight">WALL STREAK</h1>
          <p class="text-xs text-slate-500 -mt-1">Keep your streak, beat the Street</p>
        </div>
      </div>
      <div class="tag">Streak: <span id="streakVal">0</span> üî•</div>
    </header>

    <!-- Meta -->
    <section class="mb-4 flex items-center justify-between">
      <div class="tag">Theme: <span id="themeLabel">‚Äî</span></div>
      <div class="text-xs text-slate-500" id="dateLabel"></div>
    </section>

    <!-- Puzzle -->
    <main class="card" id="puzzleCard">
      <p class="mb-4 text-lg font-semibold" id="prompt">Loading today‚Äôs puzzle‚Ä¶</p>

      <!-- MCQ grid -->
      <div id="mcqContainer" class="grid grid-cols-2 gap-3 mb-4"></div>

      <div class="flex items-center gap-3">
        <button id="revealBtn" class="btn btn-reveal">Give up & reveal</button>
      </div>

      <p id="feedback" class="mt-4 text-sm font-semibold"></p>
    </main>

    <!-- Result Box (replaces white card) -->
    <section id="resultBox" class="resultBox hidden">
      <div id="resultTitle" class="result-title"></div>
      <p class="result-sub">
        Answer: <span id="answerText" class="font-semibold"></span>
      </p>

      <div class="rounded-xl border border-amber-300 bg-amber-50 p-4">
        <div class="text-amber-700 font-black tracking-wide text-sm mb-1">STREET CHEAT OF THE DAY</div>
        <p id="cheatText" class="text-amber-900"></p>
      </div>

      <div class="mt-4 flex flex-wrap items-center gap-3">
        <button id="shareBtn" class="btn btn-secondary">Share result</button>
        <button id="doneBtn" class="btn btn-primary">Done</button>
      </div>
    </section>

    <!-- Streak Summary -->
    <section id="summaryCard" class="card mt-6 hidden">
      <h3 class="text-xl font-extrabold mb-2">Your Streak</h3>
      <p class="text-slate-700 mb-4">
        Current streak: <span id="summaryStreak" class="font-bold"></span> üî•
      </p>
      <div class="rounded-xl border border-slate-200 bg-slate-50 p-4 mb-4">
        <p id="summaryLine" class="text-slate-700"></p>
      </div>
      <div class="flex items-center gap-3">
        <button id="shareAgainBtn" class="btn btn-secondary">Share again</button>
        <button id="backToTopBtn" class="btn">Back to top</button>
      </div>
    </section>

    <footer class="mt-10 text-center text-xs text-slate-400">
      ¬© <span id="year"></span> Wall Streak ‚Äî MVP
    </footer>
  </div>

  <script>
    // ---------- Utilities ----------
    function getUTCDateKey() {
      const now = new Date();
      return Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()) / 86400000;
    }
    function nextMondayEndLocal() {
      const now = new Date();
      const dow = now.getDay(); // 0 Sun .. 6 Sat
      const delta = (1 - dow + 7) % 7; // days until Monday (0 if Monday)
      const target = new Date(now);
      target.setDate(now.getDate() + delta);
      target.setHours(23,59,59,999);
      return target;
    }

    // ---------- Puzzles (MCQ, Mon‚ÄìSat) ----------
    const PUZZLES = [
      // Monday ‚Äî Market News
      {
        theme: "Market News",
        prompt: "This US government announced a shutdown on the 30 September 2025. Since the 1980s, how many government shutdowns have there been?",
        options: ["8","10","12","15"],
        answer: "10",
        answerDisplay: "10",
        cheat: "Government shutdowns are more frequent than most people think. Their impact on stocks is usually short-lived ‚Äî no need for panic."
      },
      // Tuesday ‚Äî Valuation
      {
        theme: "Valuation",
        prompt: "This bank trades at a Price-to-Book ratio under 1.0, suggesting the market values it below its assets. Guess the ticker.",
        options: ["JPM","GS","C","MS"],
        answer: "C",
        answerDisplay: "C (Citigroup)",
        cheat: "P/B ‚âà 1 means market ‚âà book value. Below 1 may signal undervaluation ‚Äî or real risk. Always look beyond headlines."
      },
      // Wednesday ‚Äî Fundamental
      {
        theme: "Fundamental Analysis",
        prompt: "This company‚Äôs revenue surged during the pandemic from e-commerce growth, but its operating margins remain thin. Guess the ticker.",
        options: ["AMZN","EBAY","SHOP","WMT"],
        answer: "AMZN",
        answerDisplay: "AMZN (Amazon)",
        cheat: "Revenue growth is exciting, but profits pay the bills. Always also check net income, because investors / shareholders get paid last."
      },
      // Thursday ‚Äî Technical
      {
        theme: "Technical Analysis",
        prompt: "The stock‚Äôs 50-day moving average crossed above the 200-day moving average. What‚Äôs this signal called?",
        options: ["Golden Cross","Death Cross","Double Bottom","Breakout"],
        answer: "Golden Cross",
        answerDisplay: "Golden Cross",
        cheat: "Technical signals like the Golden Cross show momentum shifts ‚Äî but know whether you‚Äôre trading or investing."
      },
      // Friday ‚Äî Behavioral
      {
        theme: "Behavioral",
        prompt: "An investor keeps buying meme stocks because everyone online is hyping them up. What bias is this?",
        options: ["Overconfidence","Anchoring","Herding","Recency"],
        answer: "Herding",
        answerDisplay: "Herding",
        cheat: "Following the crowd can be costly. Ask if price moves are driven by fundamentals or just momentum."
      },
      // Saturday ‚Äî Economics
      {
        theme: "Economics",
        prompt: "This country reported inflation over 8% in 2022, leading its central bank to raise interest rates aggressively. Guess the country.",
        options: ["Germany","Japan","United States","UK"],
        answer: "United States",
        answerDisplay: "United States",
        cheat: "High inflation usually forces rate hikes ‚Äî cooling demand but pressuring housing and growth stocks."
      }
    ];

    // ---------- State ----------
    const storage = {
      get streak() { return parseInt(localStorage.getItem('ws_streak') || '0', 10); },
      set streak(v) { localStorage.setItem('ws_streak', String(v)); },
      get lastPlayedKey() { return localStorage.getItem('ws_lastKey'); },
      set lastPlayedKey(k) { localStorage.setItem('ws_lastKey', k); },
    };

    const els = {
      themeLabel: document.getElementById('themeLabel'),
      dateLabel: document.getElementById('dateLabel'),
      streakVal: document.getElementById('streakVal'),
      prompt: document.getElementById('prompt'),
      mcqContainer: document.getElementById('mcqContainer'),
      revealBtn: document.getElementById('revealBtn'),
      feedback: document.getElementById('feedback'),
      resultBox: document.getElementById('resultBox'),
      resultTitle: document.getElementById('resultTitle'),
      answerText: document.getElementById('answerText'),
      cheatText: document.getElementById('cheatText'),
      shareBtn: document.getElementById('shareBtn'),
      doneBtn: document.getElementById('doneBtn'),
      summaryCard: document.getElementById('summaryCard'),
      summaryStreak: document.getElementById('summaryStreak'),
      summaryLine: document.getElementById('summaryLine'),
      shareAgainBtn: document.getElementById('shareAgainBtn'),
      backToTopBtn: document.getElementById('backToTopBtn'),
      year: document.getElementById('year'),
      puzzleCard: document.getElementById('puzzleCard'),
    };

    const today = new Date();
    els.year.textContent = today.getFullYear();
    els.dateLabel.textContent = today.toLocaleDateString(undefined, { weekday: 'long', year: 'numeric', month: 'short', day: 'numeric' });

    let lastResultWon = null; // for summary/share

    // ---------- Live-test Monday until next Monday 23:59 ----------
    function themeForTodayNormal() {
      const dow = new Date().getDay(); // 0 Sun..6 Sat
      return ["Sunday","Market News","Valuation","Fundamental Analysis","Technical Analysis","Behavioral","Economics"][dow];
    }
    function nextMondayEndLocal() {
      const now = new Date();
      const dow = now.getDay();
      const delta = (1 - dow + 7) % 7; // days until Monday
      const target = new Date(now);
      target.setDate(now.getDate() + delta);
      target.setHours(23,59,59,999);
      return target;
    }
    function chooseTodayPuzzle() {
      const now = new Date();
      const mondayEnd = nextMondayEndLocal();
      if (now < mondayEnd) {
        const p = PUZZLES.find(x => x.theme === "Market News");
        return { key: String(getUTCDateKey()), puzzle: p, theme: "Market News" };
      }
      const theme = themeForTodayNormal();
      if (theme === "Sunday") return null;
      const p = PUZZLES.find(x => x.theme === theme);
      return { key: String(getUTCDateKey()), puzzle: p, theme };
    }

    const choice = chooseTodayPuzzle();
    const currentKey = choice ? choice.key : null;

    if (!choice) {
      els.puzzleCard.innerHTML = `
        <div class="text-center">
          <div class="text-4xl mb-2">üòé</div>
          <h2 class="text-xl font-bold">No puzzle today</h2>
          <p class="text-slate-600">Wall Streak runs Monday‚ÄìSaturday. See you tomorrow!</p>
        </div>`;
      els.themeLabel.textContent = "Sunday ‚Äî Rest Day";
    } else {
      const p = choice.puzzle;
      els.themeLabel.textContent = choice.theme;
      els.streakVal.textContent = storage.streak;
      renderMCQ(p);
      els.revealBtn.onclick = () => giveUp(p);
      els.shareBtn.onclick = () => shareResult(p.theme, lastResultWon === true, p.cheat, storage.streak);
      els.doneBtn.onclick = () => showSummary(choice.theme);
      els.shareAgainBtn.onclick = () => shareResult(choice.theme, lastResultWon === true, p.cheat, storage.streak);
      els.backToTopBtn.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // ---------- Render MCQs ----------
    function renderMCQ(p) {
      els.prompt.textContent = p.prompt;
      els.feedback.textContent = '';
      els.resultBox.className = 'resultBox hidden';
      els.summaryCard.classList.add('hidden');
      els.mcqContainer.innerHTML = '';

      const colorClasses = ['mcq-a','mcq-b','mcq-c','mcq-d'];
      p.options.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.className = `mcq ${colorClasses[i % colorClasses.length]}`;
        btn.textContent = opt;
        btn.onclick = () => checkMCQ(opt, p, btn);
        els.mcqContainer.appendChild(btn);
      });
    }

    function normalize(s) { return (s||'').trim().toUpperCase(); }

    function lockMCQ() {
      Array.from(els.mcqContainer.children).forEach(b => b.disabled = true);
    }

    function checkMCQ(value, p, btnEl) {
      const correct = normalize(value) === normalize(p.answer);
      if (correct) {
        btnEl.classList.remove('wrong'); btnEl.classList.add('correct');
        if (storage.lastPlayedKey !== currentKey) {
          storage.streak = storage.streak + 1;
          storage.lastPlayedKey = currentKey;
        }
        lastResultWon = true;
        lockMCQ();
        showResult(true, p);
      } else {
        btnEl.classList.add('wrong');
        els.feedback.textContent = 'Not quite ‚Äî try again.';
        lastResultWon = false;
      }
      els.streakVal.textContent = storage.streak;
    }

    function giveUp(p) {
      if (storage.lastPlayedKey !== currentKey) {
        storage.streak = 0;
        storage.lastPlayedKey = currentKey;
      }
      els.streakVal.textContent = storage.streak;
      lastResultWon = false;
      lockMCQ();
      showResult(false, p);
    }

    // ---------- Result box (green/red with icons) ----------
    function showResult(won, p) {
      els.answerText.textContent = p.answerDisplay || p.answer;
      els.cheatText.textContent  = p.cheat;

      els.resultBox.classList.remove('hidden','result-success','result-fail');
      els.resultBox.classList.add(won ? 'result-success' : 'result-fail');

      els.resultTitle.innerHTML = won
        ? `<span>‚úÖ</span><span>You beat the Street!</span>`
        : `<span>‚ùå</span><span>Today you got Street-schooled!</span>`;
    }

    // ---------- Summary ----------
    function showSummary(theme) {
      els.summaryStreak.textContent = storage.streak;
      const mark = lastResultWon ? '‚úÖ' : '‚ùå';
      els.summaryLine.textContent = `${theme}: ${mark} ‚Äî Keep your streak, beat the Street!`;
      els.summaryCard.classList.remove('hidden');
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    // ---------- Share ----------
    function shareResult(theme, won, cheat, streak) {
      const text = `Wall Streak ${streak} üî•
${theme}: ${won ? '‚úÖ' : '‚ùå'}
Street Cheat: ${cheat}`;
      if (navigator.share) navigator.share({ text }).catch(() => navigator.clipboard.writeText(text));
      else { navigator.clipboard.writeText(text); alert('Result copied! Paste anywhere to share.'); }
    }
  </script>
</body>
</html>



